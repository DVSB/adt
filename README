This project is a set of tools used to automate the deployment of eXo products for testing purpose.

How to use ?
============

Prerequisites
------------------------

A local Mysql server
A Java 6 JVM available in the PATH

Prepare your environment
------------------------
Fork this project :

    git clone https://git.exoplatform.org/public/tools/adt
    
Define the environment variable ADT_DATA, which will be the path to a working directory used by ADT.

    export ADT_DATA=$HOME/adt_data

You'll need also to define 

   MYSQL_CREDENTIALS or use the option -m to set credentials used to create/delete databases

   REPO_CREDENTIALS or use the option -r to download artifacts from our private repositories
    
You can also define your settings in $HOME/.adtrc or in /etc/default/adt
    
You're ready to go
------------------

Deploy a server : download and configure it

    # adt.sh deploy social 1.3.0-SNAPSHOT
    
Start a server : start a deployed instance
    
    # adt.sh start social 1.3.0-SNAPSHOT

Stop a server : stop a deployed instance

    # adt.sh stop social 1.3.0-SNAPSHOT

Restart a server : restart a deployed instance

    # adt.sh restart social 1.3.0-SNAPSHOT

Undeploy a server : stop a deployed instance if already running and delete it.

    # adt.sh undeploy social 1.3.0-SNAPSHOT

List all deployed instances

    # adt.sh list

Usage
-----

    usage: ./adt.sh action [product] [version] [options]
    
    This script manages automated deployment of eXo products for testing purpose.
    
    ACTION :
      deploy       Deploys (Download+Configure) the server
      start        Starts the server
      start-all    Starts all deployed servers
      stop         Stops the server
      stop-all     Stops all deployed servers
      restart      Restarts the server
      restart-all  Restarts all deployed servers
      undeploy     Undeploys (deletes) the server
      undeploy-all Undeploys (deletes) all deployed servers
      list         Lists all deployed servers
      
    PRODUCT (for deploy, start, stop, restart, undeploy actions) :
      gatein       GateIn Community edition
      exogtn       GateIn eXo edition
      webos        eXo WebOS
      social       eXo Social
      ecms         eXo Content
      ks           eXo Knowledge
      cs           eXo Collaboration
      platform     eXo Platform
    
    VERSION (for deploy, start, stop, restart, undeploy actions) :
      version of the product

    GLOBAL OPTIONS :
      -h           Show this message  
    
    DEPLOY OPTIONS [ environment variable to use to set a default value ] :
      -A <value>   AJP Port (default: 8009) [ $DEPLOYMENT_AJP_PORT ]
      -H <value>   HTTP Port (default: 8080) [ $DEPLOYMENT_HTTP_PORT ]
      -S <value>   SHUTDOWN Port (default: 8005) [ $DEPLOYMENT_SHUTDOWN_PORT ]
      -R <value>   RMI Registry Port for JMX (default: 10001) [ $DEPLOYMENT_RMI_REG_PORT ]
      -V <value>   RMI Server Port for JMX (default: 10002) [ $DEPLOYMENT_RMI_SRV_PORT ]
      -g <value>   Repository group where to download the artifact from. Values : public | staging | private (default: public) [ $ARTIFACT_REPO_GROUP ]
      -r <value>   user credentials in "username:password" format to download the server package (default: none) [ $REPO_CREDENTIALS ]
      -k           Keep the current database content. By default the deployment process drops the database if it already exists.

    DEPLOY/UNDEPLOY OPTIONS [ environment variable to use to set a default value ] :
      -m <value>   user credentials in "username:password" format to manage the database server (default: none) [ $MYSQL_CREDENTIALS ]  
